<div *ngIf="orderDetails" class="px-36">
  <div class="flex justify-between">
    <button class="bg-green-600 px-5 py-2 rounded-md text-white mb-4 hover:bg-green-700" routerLink="/order-list">
      Back to List
    </button>
    <button class="bg-green-600 text-white px-4 py-1 rounded mb-4 hover:bg-green-700" (click)="exportOrders()">
      Export This Order As Excel File
    </button>
  </div>
  <div class="bg-white px-5 py-3 rounded-md shadow-lg">
    <h2 class="text-2xl font-bold mb-4">Order Details</h2>
    <p><strong>Customer Name :</strong> {{ orderDetails.customerName }}</p>
    <p><strong>Phone Number :</strong> {{ orderDetails.customerPhone }}</p>
    <p><strong>Address :</strong> {{ orderDetails.address }}</p>

    <div *ngIf="orderDetails.orderItems?.length" class="mt-6">
      <h3 class="text-xl font-semibold mb-2">Order Items</h3>
      <table class="table-auto border-collapse border border-gray-400 w-full">
        <thead>
          <tr class="bg-gray-100">
            <th class="border border-gray-400 px-4 py-2">#</th>
            <th class="border border-gray-400 px-4 py-2">Product Name</th>
            <th class="border border-gray-400 px-4 py-2">Price</th>
            <th class="border border-gray-400 px-4 py-2">Quantity</th>
            <th class="border border-gray-400 px-4 py-2">Total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of orderDetails.orderItems; let i = index">
            <td class="border border-gray-400 px-4 py-2">{{ i + 1 }}</td>
            <td class="border border-gray-400 px-4 py-2">{{ item.productName }}</td>
            <td class="border border-gray-400 px-4 py-2">{{ item.productPrice | number:'1.0-0' }}</td>
            <td class="border border-gray-400 px-4 py-2">{{ item.quantity }}</td>
            <td class="border border-gray-400 px-4 py-2">
              {{ item.productPrice * item.quantity | number:'1.0-0' }}
            </td>
          </tr>
          <tr class="bg-gray-100 font-bold">
            <td colspan="4" class="border border-gray-400 px-4 py-2 text-right">Grand Total</td>
            <td class="border border-gray-400 px-4 py-2">{{ orderDetails.totalPrice | number:'1.0-0' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>